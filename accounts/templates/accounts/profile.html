<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Online Tic Tac Toe</title>
    <style>
      body{
        margin: 0;
        padding: 0;
        width: 300px;
        height: 407px;
        background-color: #EEE;
        overflow: hidden;
        overflow-y: auto;
      }
      #div1{
        margin: auto;
        text-align: center;
      }
      .btns{
        height: 50px;
        width: 70px;
        margin: 10px;
        background-color: #00B;
        color: #EEE;
        border: 2px solid #007;
        border-radius: 10px;
      }
      #profile_pic{
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin: 25px;
        padding: 0px;
        position: relative;
        top: -78px;
        background-color:#EEE;
        border: 3px solid #009;
        box-shadow: 0px 0px 5px #0009;
      }
      #space{
        width: 100%;
        height: 75px;
      }
      #img_div{
        height: 128px;
      }
      #username{
        font-family: Times New Roman;
        font-size: 18px;
        padding: 0;
        margin: 0;
        margin-top: 5px;
      }
      #user_stats{
        text-align: left;
        padding-left: 10px;
      }
      .fa{
        font-size: 25px;
      }
      #inside{
        font-size: 11px;
        padding: 0;
        margin: 0;
      }
      #mh{
        font-size: 20px;
        margin: 5px;
        background-color: #00A;
        color: #EEE;
        border: 2px solid #007;
      }
      #hr1{
        margin: 0px auto;
        padding: 0;
        width: 90%;
        border: 1px solid #0077;
      }
      fieldset{
        width: 85%;
        border: 2px solid #000;
        margin: 0px auto;
        margin-bottom: 10px;
        border-radius: 20%;
        padding: 0;
      }
      .matchinfo{
        text-align: left;
        font-size: 14px;
        padding: 0;
        padding-left: 5px;
        margin: 3px;
      }
      .date{
        text-align: right;
        font-size: 12px;
        padding: 0;
        padding-right: 5px;
        margin: 3px;
      }
      .matchspan{
        color: #000;
        font-weight: bold;
      }
      .Win{
        color: #070;
      }
      .Lose{
        color: #700;
      }
      .Draw{
        color: #007;
      }
      legend{
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div id="div1">
      <div id="img_div">
        <div id="space"></div>
        <img id="profile_pic" src="{{ user.image.url }}">
      </div>
      <p id="username">{{ user }}</p>
      <button class="btns" onclick="logout()"><i class="fa fa-sign-out"></i></br><p id="inside">Log out</p></button>
      <a href="{% url 'accounts:settings' %}"><button class="btns"><i class="fa fa-cog"></i></br><p id="inside">Edit profile</p></button></a>
      <button class="btns" onclick="copylink()"><i class="fa fa-share"></i></br><p id="inside">Share</p></button>
      <div id="user_stats">
        <p>Played {{ user.total_games }} games</p>
        <p>win : {{ user.won_games }}</p>
        <p>lose : {{ user.lost_games }}</p>
        <p>draw : {{ user.draw_games }}</p>
        <p>win rate : {{ win_rate }} %</p>
      </div>
      <div id="match_history"><hr id="hr1">
        <p id="mh">‹Recent {{ history.count }} Games›</p>
        {% for match in history %}
          <fieldset>

            {% if match.winner == user %}
              <legend class="Win">Win</legend>
              <p class="matchinfo">You VS <span class="matchspan">{{ match.loser }}</span></p>
            {% elif match.loser == user %}
              <legend class="Lose">Lose</legend>
              <p class="matchinfo">You VS <span class="matchspan">{{ match.winner }}</span></p>
            {% else %}
              <legend class="Draw">Draw</legend>
              <p class="matchinfo">You VS <span class="matchspan">
                {% for player in match.draw.all %}
                {% if player != user %}
                {{player}}
                {%  endif %}
                {% endfor %}
              </span></p>
            {% endif %}
              <p class="date">{{match.time|date:'M. j, g:i A'}}</p>
          </fieldset>
        {% endfor %}
        <br></div>
      </div>
    </div>
  </body>
  <script>
    var user_id = "{{user.front_id}}";
          function copylink() {
            var TempText = document.createElement("input");
            var url = window.location.href
            var TextToCopy = url.slice(0, url.indexOf("/", 10)+1)+ "?user="+user_id;
            TempText.value = TextToCopy;
            document.body.appendChild(TempText);
            TempText.select();
            document.execCommand("copy");
            document.body.removeChild(TempText);
            alert("Copied the text: " + TempText.value);
          }
          
          
          function logout()
          {
            let isExecuted = confirm("Are you sure to log out ?!");
            
            if(isExecuted)
            {
              window.open("{% url 'accounts:logout' %}" , "_self");
            }
          }
  </script>
</html>
