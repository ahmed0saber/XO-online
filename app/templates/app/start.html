{% load static %}
<!DOCTYPE html>
<html>

<head>
    <title>Online Tic Tac Toe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="{% static 'manifest.webmanifest' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="{% static 'logo/tic-tac-toe.svg' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #header {
            margin: 0px auto;
            padding: 0;
            width: 304px;
            height: 454px;
            border: 2px solid black;
            background-color: #CCF;
            border: 2px solid #33F;
            box-shadow: 0 0 5px #117;
            box-sizing: border-box;
        }

        .h_btns {
            margin: 0;
            width: 60px;
            height: 40px;
            border: none;
            background-color: #EEF;
            transition-duration: 0.4s;
        }

        .h_btns:hover {
            background-color: #AAF
        }

        #selected {
            height: 3px;
            background-color: blue;
            width: 60px;
            margin-left: 0px;
            transition-duration: 0.4s;
        }

        #iframe1 {
            height: 407px;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
            border: none;
            display: none;
        }

        .fa {
            font-size: 25px;
            color: #117;
            background: transparent
        }

        #loading {
            height: 407px;
            overflow-x: hidden;
            overflow-y: hidden;
            margin: 0;
            padding: 0;
            border: none;
            display: block;
            background-color: #FFF;
        }

        #status {
            height: 200px;
            width: 200px;
            margin: 104px 50px;
            background-image: url(https://raw.githubusercontent.com/niklausgerber/PreLoadMe/master/img/status.gif);
            background-repeat: no-repeat;
            background-position: center;
        }
    </style>
</head>

<body onload="checkurl()">
    <div id="header">
        <button class="h_btns" onclick="move(1)"><i class="fa fa-home"></i></button><button class="h_btns"
            onclick="move(2)"><i class="fa fa-trophy"></i></button><button class="h_btns" onclick="move(3)"><i
                class="fa fa-envelope"></i></button><button class="h_btns" onclick="move(4)"><i
                class="fa fa-bell"></i></button><button class="h_btns" onclick="move(5)"><i
                class="fa fa-user"></i></button>
        <div id="selected"></div>
        <iframe src="{% url 'app:home' %}" id="iframe1" onload="frameloaded()"></iframe>
        <div id="loading">
            <div id="status">&nbsp;</div>
        </div>
    </div>
</body>
<script>
    var ratio = screen.width/304;
    console.log(ratio);
    if(ratio>1.3)
    {
      ratio=1.3;
    }
    document.getElementById("header").style.transform = "scale("+ratio+")";
    var topmargin = (ratio-1)*454/2;
    document.getElementById("header").style.marginTop = topmargin+"px";
    
    
    

    function frameloaded() {
        $("#loading").css("display", "none");
        $("#iframe1").css("display", "block");
        var fwindow = document.getElementById("iframe1").contentWindow
        if (fwindow.location.pathname == '/chat/') {
            var element = fwindow.document.getElementById("msg_container");
            element.scrollTop = element.scrollHeight
        }
    }
    function move(i) {
        $("#iframe1").css("display", "none");
        $("#loading").css("display", "block");

        if (i == 1) {
            $("#selected").css("margin-left", "0px");
            $("#iframe1").attr("src", "{% url 'app:home' %}");
        }
        else if (i == 2) {
            $("#selected").css("margin-left", "60px");
            $("#iframe1").attr("src", "{% url 'app:board' %}");
        }
        else if (i == 3) {
            $("#selected").css("margin-left", "120px");
            $("#iframe1").attr("src", "{% url 'chat:chat' %}");
        }
        else if (i == 4) {
            $("#selected").css("margin-left", "180px");
            $("#iframe1").attr("src", "{% url 'app:notifications' %}");
        }
        else if (i == 5) {
            $("#selected").css("margin-left", "240px");
            $("#iframe1").attr("src", "{% url 'accounts:profile' %}");
        }
    }

    function checkurl() {
        var url = window.location.href;
        console.log(url);

        let ourSubstring = "user";

        if (url.includes(ourSubstring)) {
            console.log("The word Example is in the string.");


            var myUrl = new URL(url);
            var user_id = myUrl.searchParams.get("user");
            console.log(user_id);
            $("#iframe1").attr("src", url.slice(0, url.indexOf('?')) + "accounts/user/" + user_id);
            history.pushState({}, null, url.slice(0, url.indexOf('?')));

        } else {
            console.log("The word Example is not in the string.");
        }
    }
</script>

</html>
